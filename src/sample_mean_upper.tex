\section{Constant Memory with full window}

In this work we investigate an variant of the above process.
We denote by $V$ the set of agents, and $N_{i} \subset V$ the set of neighbors
of agent $i$.
Let $x(t) \in [0,1]^n$ be the opinion vector at round $t$.
We denote by $x_i(t)$ the opinion of agent $i$ at round $t$.
At round $t+1$, $x(t+1)$ is constructed in the following way.
At first, each agent $i$ gets to see
the opinion $x_j(t)$, where $j \in N_i$ is picked uniformly at random
from the set of her neighbors.  Let $W_i^t$ be the random variable
corresponding to the selected neighbor. Now each agent $i \in V$
updates her opinion as follows
\[
  x_i(t+1) =
  (1-\alpha_i)\frac{\sum_{\tau=1}^{t+1} x_{W_i^\tau}(\tau-1)}{t+1}
  + \alpha_i s_i.
\]
We remark that each agent $i$ get to see \emph{only} the opinion
$x_{W_i^t}$ and not the label $W_i^t$ of her neighbor.

Let $x^* \in [0,1]^n$ be the unique equilibrium point
of the given instance $I$. We prove that
the above stochastic process has the following convergence
rate to $x^*$.
\begin{theorem}

  \[
    \Expnew{}{\norm{\infty}{x^t - x^*}} \leq
      C \sqrt{\log n}\frac{(\log t)^{2}}{t^{\min(1/2,\rho)}},
  \]
\end{theorem}
\begin{proof}
  Setting $p = 1/\sqrt{t}$ in Lemma~\ref{l:error_bound} yields
  the result.
\end{proof}

We start by stating the standard Hoeffding bound

\begin{lemma}[Hoeffding's Inequality]\label{l:hoeffding}
  Let $X = (X_1 +\cdots + X_t) /t$, $X_i \in [0,1]$.
  Then,
  \[
    \Prob{|X - \Exp{X} | > \lambda} < 2 e^{-2 t \lambda^2}.
  \]
\end{lemma}

\begin{lemma}\label{l:error_recursion}
  With probability at least $1-p$, $\|x^t - x^*\|_{\infty} \leq e(t)$,
  where $e(t)$ satisfies the following recursive relation
  $$e(t) =
  \delta(t) + (1-\alpha)\frac{\sum_{\tau=0}^{t-1}e(\tau)}{t}
  \text{ and } e(0)=\|x^0 - x^*\|_{\infty}, $$
  where $\delta(t) = \sqrt{ \frac{\log(\pi^2 n t^2/(6 p))}{t}}$.
\end{lemma}
\begin{corollary}\label{c:error_recursion}
  The function $e(t)$ satisfies the following recursive relation
  $$e(t+1)-e(t) + \alpha \frac{e(t)}{t+1}=\delta(t+1)-\delta(t) + \frac{\delta(t)}{t+1}$$
\end{corollary}
\begin{proof}
  As we have already mentioned for any instance $I$ there exists
  a unique equilibrium vector $x^*$. Since
  $W_i^\tau \sim \Unif(N_i)$ we have that $
  \Exp{x^*_{W_i^\tau}} = \frac{\sum_{j \in N_i} x^*_j}{|N_i|}
  $.
  Since $W_i^\tau$ are independent random variables, we can use
  Hoeffding's inequality (Lemma~\ref{l:hoeffding}) to get
  \[
    \Prob
    {
      \lp|
      \frac{\sum_{\tau = 1}^{t} x^*_{W_i^\tau}}{t}
      - \frac{\sum_{j \in N_i} x^*_j}{|N_i|} \rp|
      > \delta(t)
    }
    < \frac{6}{\pi^2} \frac{p}{ n t^2},
  \]
  where $\delta(t) = \sqrt{ \frac{\log(\pi^2 n t^2/(6 p))}{t}}$.
  Therefore, by the union bound
  \begin{align*}
    &\Prob
    {
      \text{for all } t \geq 1 :
      \max_{i \in V}
      \lp|
      \frac{\sum_{\tau = 1}^{t} x^*_{W_i^{\tau}}}{t}
      - \frac{\sum_{j \in N_i} x^*_j}{|N_i|} \rp|
      > \delta(t)} \leq \\
    &\sum_{t =1 }^{\infty} \Prob
    {
      \max_{i \in V}
      \lp|
      \frac{\sum_{\tau = 1}^{t} x^*_{W_i^{\tau}}}{t}
      - \frac{\sum_{j \in N_i} x^*_j}{|N_i|} \rp|
      > \delta(t)} \leq
    \\
    &\sum_{i=1}^{\infty} \frac{6}{\pi^2} \frac{1}{t^2} \sum_{i=1}^n \frac{p}{n} =
    p
  \end{align*}

  As a result with probability $1-p$ we have that for all $t$
  \begin{equation}\label{eq:error_per_round}
    \lp|
    \frac{\sum_{\tau=1}^t x^*_{W_i^\tau}}{t} -
    \frac{\sum_{j \in N_i} x^*_j}{|N_i|}
    \rp| \leq \delta(t)
  \end{equation}
  We will our claim by induction.
  We assume that $\norm{\infty}{x^{\tau}-x^*} \leq e(\tau)$ for all
  $\tau \leq t-1$. Then
  \begin{align}
    x_i(t)
    &=
    (1-\alpha_i)\frac{\sum_{\tau=1}^{t}x_{W_i^{\tau}}(\tau-1)}{t}
    + \alpha_i s_i \nonumber \\
    &\leq
    (1-\alpha_i)\frac{\sum_{\tau=1}^{t}x^*_{W_i^{\tau}} +
      \sum_{\tau=1}^{t} e(\tau-1)}{t} + \alpha_i s_i \label{step:induction_step}\\
    &\leq
    (1-\alpha_i)
    \lp(
    \frac{\sum_{\tau=1}^{t}x^*_{W_i^{\tau}}}{t}+
    \frac{\sum_{\tau=0}^{t-1} e(\tau)}{t}
    \rp)
    + \alpha_i s_i \nonumber\\
    &\leq
    (1-\alpha_i)\lp(\frac{\sum_{j \in N_i}x^*_{j}}{|N_i|} +
    \delta(t) + \frac{\sum_{\tau=0}^{t-1} e(\tau)}{t} \rp) +
    \alpha_i s_i \label{step:error} \\
    &\leq
    x_i^* + \delta(t) + (1-\alpha)
    \lp(
    \frac{\sum_{\tau=0}^{t-1} e(\tau)}{t}
    \rp)
    \nonumber
  \end{align}
  We get (\ref{step:induction_step}) from the induction step and
  (\ref{step:error}) from inequality~(\ref{eq:error_per_round}).
  Similarly, we can prove that
  $x_i(t) \geq x_i^* - \delta(t) - (1-\alpha)
  \frac{\sum_{\tau=1}^t e(\tau)}{t}$.
  As a result $||x_i(t)-x^*||_{\infty} \leq e(t)$.
\end{proof}

In order to bound the convergence time of the system, we just need to bound
the convergence rate of the function $e(t)$.
The following lemma provides us with a simple upper bound for the
convergence rate of our process.

% \begin{lemma}\label{l:error_bound}
%   $$e(t) \leq \frac{e(0)}{t^\alpha} +
%   \frac{\bigOh{\sqrt{\log(\frac{nd}{p})}}}{t^\alpha}
%   \sum_{\tau=1}^t\tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}$$
% \end{lemma}

\begin{lemma}\label{l:error_bound}
  Let $e(t)$ be a function satisfying the recursion of
  Corollary~\ref{c:error_recursion}. Then with probability
  at least $1-p$ we have that
  \[
    e(t) =
    \begin{cases}
      \bigOh{\sqrt{\log(\frac{n}{p})}\frac{(\log t)^{3/2}}{t^\alpha}}
      &\quad\text{if } \alpha \leq 1/2\\
      \bigOh{\sqrt{\log(\frac{n}{p})}\frac{(\log t)^{3/2}}{t^{1/2}}}
      &\quad\text{if } \alpha > 1/2\\
    \end{cases}
  \]
\end{lemma}

\begin{proof}
  At first, since $\frac{\delta(t)}{t}$ is a decreasing function
  for $p \leq 1/4$, we have that
  $e(t)\leq (1-\frac{\alpha}{t}) + g(t)$, where $g(t)=\frac{\delta(t)}{t}$.
  \begin{align*}
    e(t)
    &\leq
    (1-\frac{\alpha}{t})e(t-1) + g(t)\\
    &\leq
    (1-\frac{\alpha}{t})(1-\frac{\alpha}{t-1})e(t-2)
    + (1-\frac{\alpha}{t})g(t-1) + g(t)\\
    &\leq
    (1-\frac{\alpha}{t})\cdots (1-\alpha)e(0)
    + \sum_{\tau=1}^t g(\tau)\prod_{i=\tau+1}^t(1-\frac{\alpha}{i})\\
    &\leq
    \frac{e(0)}{t^\alpha}
    + \sum_{\tau=1}^tg(\tau)e^{-\alpha\sum_{i=\tau+1}^t\frac{1}{i}}\\
    &\leq
    \frac{e(0)}{t^\alpha}
    + \sum_{\tau=1}^tg(\tau)e^{-\alpha(H_t-H_{\tau})}\\
    &\leq
    \frac{e(0)}{t^\alpha}
    + e^{-\alpha H_t}\sum_{\tau=1}^tg(\tau)e^{\alpha H_{\tau}}\\
    &\leq \frac{e(0)}{t^\alpha}
    + \frac{\bigOh{\sqrt{\log(\frac{n}{p})}}}{t^\alpha}
    \sum_{\tau=1}^t\tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}\\
  \end{align*}

  We observe that
  \[
    \sum_{\tau=1}^t\tau^\alpha
    \frac{\sqrt{\log \tau}}{\tau^{3/2}}
    \leq
    \int_{\tau=1}^t
    \tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}d\tau,
  \]
  since $\tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}$
  \begin{itemize}
    \item If
  $\alpha\leq 1/2$ then
  \[
    \int_{\tau=1}^t \tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}d\tau
    \leq
    \int_{\tau=1}^t
    \tau^{1/2}\frac{\sqrt{\log \tau}}{\tau^{3/2}}d\tau = O((\log t)^{3/2}))
  \]
\item If $\alpha> 1/2$ then\\
  \begin{align*}
    \int_{\tau=1}^t
    \tau^\alpha\frac{\sqrt{\log \tau}}{\tau^{3/2}}d\tau
    &=
    \int_{\tau=1}^t \tau^{\alpha-1/2}\frac{\sqrt{\log \tau}}{\tau}d\tau \\
    &=
    \frac{2}{3} \int_{\tau=1}^t
    \tau^{\alpha-1/2}((\log \tau)^{3/2})'d\tau \\
    &=
    \frac{2}{3}(\log t)^{3/2} - (\alpha-1/2)\frac{2}{3}
    \int_{\tau=1}^t \tau^{\alpha-3/2}(\log \tau)^{3/2}d\tau \\
    &=
    \bigOh{(\log t)^{3/2}}
  \end{align*}

\end{itemize}

\end{proof}
